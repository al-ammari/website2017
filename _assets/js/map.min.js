var myIp="",myCity="",myCountry="",myIsp="",myAsn="",myLat="",myLong="",init=function(){getMyLocation(),setUpGMaps(),setUpClickHandlers(),setDefaultMapSettings(),getLayers(),populateLayersContainer(),getPrivacyReport(),0==initMode?jQuery(".opening.modal").modal("show"):1==initMode?submitCustomQuery(trIdFilter):2==initMode&&processPostedData(postedData),createASRow("first"),loadAutoCompleteData("country"," "),loadAutoCompleteData("region"," "),loadAutoCompleteData("city"," "),loadAutoCompleteData("zipCode"," "),loadAutoCompleteData("ISP"," "),loadAutoCompleteData("submitter"," "),firstLoad=!1},getMyLocation=function(){jQuery("#my-location-status").html("Loading location...");var a={action:"getMyLocation"};jQuery.ajax(url_base+"/application/controller/mygeoip.php",{type:"post",data:a,success:function(a){console.log("getMyLocation data loaded ");var b=jQuery.parseJSON(a);console.log(b),setMyLocationData(b)},error:function(a){console.log("Error! getMyLocation data can't be loaded",a)}})},setMyLocationData=function(a){jQuery("#my-location-status").html(""),myIp=a.myIp,myCity=a.myCity,myCountry=a.myCountry,myIsp=a.myIsp,myAsn=a.myAsn,myLat=a.myLat,myLong=a.myLong,jQuery(".userloc-ip").text(myIp),jQuery(".userloc-city").val(myCity),jQuery(".userloc-country").val(myCountry),jQuery(".userloc-isp").text(myIsp),jQuery(".userloc-asn").text(myAsn)},setUpClickHandlers=function(){jQuery("#search-header .qs-last-contributed-btn").click(function(){constructLastContributed()}),jQuery("#search-header .qs-via-nsa-city-btn").click(function(){constructViaNSA()}),jQuery("#search-header .qs-via-boomerangs-btn").click(function(){constructBoomerangs()}),jQuery("#search-header .qs-from-my-isp-btn").click(function(){constructFromMyIsp()}),jQuery("#search-header .qs-from-my-cty-btn").click(function(){constructFromMyCity()}),jQuery("#search-header .qs-from-my-country-btn").click(function(){constructFromMyCountry()}),jQuery("#bs-submit-btn").click(function(){constructBS()}),jQuery("#as-submit-btn").click(function(){constructAS()}),jQuery("#as-clear-btn").click(function(){jQuery(".advanced.input-holder").remove(),createASRow("first")}),jQuery("#myloc-submit-btn").click(function(){submitUserLocObject(),jQuery(".opening.modal").modal("hide")}),jQuery(".map-settings-button").click(function(){jQuery(".settings.modal").modal("show")}),jQuery("#map-help-btn").click(function(){jQuery(".map-help.modal").modal("show")}),jQuery("#remove-all-trs-btn").click(function(){removeAllTrs()}),jQuery("#add-all-trs-btn").click(function(){addAllTrs()}),jQuery("#cancel-query").click(function(){cancelQuery(),hideLoader()}),jQuery("#filter-results-summary-container").click(function(){jQuery("#filter-results-summary").toggle()}),jQuery("#tr-details-close-btn").click(function(){jQuery(".traceroutes.modal").modal("hide")}),jQuery("#settings-close-btn").click(function(){jQuery(".settings.modal").modal("hide")}),jQuery("#flagging-close-btn").click(function(){jQuery(".flagging.modal").modal("hide")}),jQuery("#carrier-close-btn").click(function(){jQuery(".carrier.modal").modal("hide")}),jQuery("#opening-close-btn").click(function(){jQuery(".opening.modal").modal("hide")}),jQuery("#map-help-close-btn").click(function(){jQuery(".map-help.modal").modal("hide")}),jQuery(".top.menu .item").on("click",function(){jQuery(".active").removeClass("active"),jQuery(this).addClass("active"),jQuery(".tab").hide(),jQuery("#"+jQuery(this).attr("id")+"-container").show()}),jQuery(".as-link").on("click",function(){jQuery(".active").removeClass("active"),jQuery("#as-tab").addClass("active"),jQuery(".tab").hide(),jQuery("#as-tab-container").show()}),jQuery("table").tablesorter({}),jQuery(".ui.rating").rating("disable"),jQuery("#settings-modal").click(function(){jQuery(".settings.modal").modal("show")}),jQuery("#traceroutes-modal").click(function(){jQuery(".traceroutes.modal").modal("show")}),jQuery("#router-modal").click(function(){jQuery(".router.modal").modal("show")}),jQuery("#carrier-modal").click(function(){jQuery(".carrier.modal").modal("show")}),jQuery("#opening-modal").click(function(){jQuery("#opening-modal-div").modal("show"),jQuery(".opening.modal").modal("show")}),jQuery("#flagging-modal").click(function(){jQuery("#flagging-modal-div").modal("show"),jQuery(".flagging.modal").modal("show")}),jQuery("a.from.basic-srch-itm").popup({popup:".from.popup",inline:!0,on:"click"}),jQuery(".basic-srch-itm.via").popup({popup:".via.popup",inline:!0,on:"click"}),jQuery(".basic-srch-itm.to").popup({popup:".to.popup",inline:!0,on:"click"}),jQuery(".ui.sidebar").sidebar({context:jQuery(".map-holder"),dimPage:!1,closable:!1}).sidebar("setting","transition","overlay","toggle").sidebar("attach events",".map-holder .layers-toggle .toggle.button"),jQuery(".ui.accordion").accordion(),jQuery(".toggle.button").state({})},renderTrResultTable=function(a){},bindAutocompletes=function(a,b){el=b+" .constraint-text-entry","country"==a?jQuery(el).autocomplete({source:countryTags}):"region"==a?jQuery(el).autocomplete({source:regionTags}):"city"==a?jQuery(el).autocomplete({source:cityTags}):"zipCode"==a?jQuery(el).autocomplete({source:zipCodeTags}):"ISP"==a?jQuery(el).autocomplete({source:ISPTags}):"asnum"==a?jQuery(el).autocomplete({source:ASnumTags}):"submitter"==a?jQuery(el).autocomplete({source:submitterTags}):"zipCodeSubmitter"==a?jQuery(el).autocomplete({source:zipCodeSubmitterTags}):"destHostName"==a?jQuery(el).autocomplete({source:destHostNameTags}):"ipAddr"==a?jQuery(el).autocomplete({source:ipAddressTags}):"hostName"==a?jQuery(el).autocomplete({source:hostNameTags}):"trId"==a?jQuery(el).autocomplete({source:trIdTags}):console.log("tagType is not currently implemented for autocomplete")},showLoader=function(){jQuery("#loader").show()},hideLoader=function(){jQuery("#loader").hide()},cancelQuery=function(){ajaxObj&&4!=ajaxObj.readystate&&(ajaxObj.abort(),console.log("Query submission has been canceled."))},setTableSorters=function(){console.log("Sorting TR Tables"),jQuery("#traceroutes-table").tablesorter({sortList:[[0,2]]})},loadAutoCompleteData=function(a,b){var c={action:"loadAutoCompleteData",field:a,keyword:b};jQuery.ajax(url_base+"/application/controller/autocomplete.php",{type:"post",data:c,success:function(b){console.log("Autocomplete data loaded: "+a);var c=jQuery.parseJSON(b);populateAutoCompleteArrays(a,c)},error:function(a){console.log("Error! autocomplete data can't be loaded",a)}})},populateAutoCompleteArrays=function(a,b){"country"==a?(countryTags.length=0,jQuery.each(b,function(a,b){null!=b&&countryTags.push(b)})):"region"==a?(regionTags.length=0,jQuery.each(b,function(a,b){null!=b&&regionTags.push(b)})):"city"==a?(cityTags.length=0,jQuery.each(b,function(a,b){null!=b&&cityTags.push(b)})):"asnum"==a?(ASnumTags.length=0,jQuery.each(b,function(a,b){null!=b&&ASnumTags.push(b)})):"zipCode"==a?(zipCodeTags.length=0,jQuery.each(b,function(a,b){null!=b&&zipCodeTags.push(b)})):"ISP"==a?(ISPTags.length=0,jQuery.each(b,function(a,b){null!=b&&ISPTags.push(b)})):"submitter"==a&&(submitterTags.length=0,jQuery.each(b,function(a,b){null!=b&&submitterTags.push(b)})),1==firstLoad&&firstLoadFunc()};